<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Deutsch算法详解</title>
    <url>/2019/10/06/intorduction-of-deutsch-algorithm/</url>
    <content><![CDATA[<h1 id="deutsch算法">Deutsch算法</h1>
<p>假设某函数<span class="math inline">\(f(x)\)</span>，它的定义域是<span class="math inline">\(\{0,1\}^n\)</span> ，即是长度为<span class="math inline">\(n\)</span>的01串，它的值域是<span class="math inline">\(\{0,1\}\)</span>。而且它只可能是两种，一种是常数函数 ，即$x,f(x)=c,c{0,1} <span class="math inline">\(；另一种是平衡函数，即有一半的x，使得\)</span>f(x)=0<span class="math inline">\(，有另一半\)</span>x<span class="math inline">\(，使得\)</span>f(x)=1<span class="math inline">\(。问题就是判断\)</span>f(x)$是常数函数还是平衡函数。</p>
<p><strong>传统算法</strong>：至少需要<span class="math inline">\(2^{n-1}+1\)</span>次操作，假设验证了<span class="math inline">\(2^{n-1}+1\)</span>个<span class="math inline">\(f(x)\)</span>的值后，都是某一常数c(<span class="math inline">\(c\in \{0,1\}\)</span>)，则可知<span class="math inline">\(f(x)\)</span>是常数函数，否则是平衡函数。</p>
<p><strong>量子算法</strong>：用Deutsch算法来判断，仅需一次操作即可知<span class="math inline">\(f(x)\)</span>是常数函数还是平衡函数。</p>
<p><strong>算法线路图</strong>：</p>
<p><img src="/2019/10/06/intorduction-of-deutsch-algorithm/circuit-of-deutsch-algorithm.png"></p>
<p>上边输入为<span class="math inline">\(|0\rangle^{\otimes n}\)</span>，下边输入为<span class="math inline">\(|1\rangle\)</span>。</p>
<p><span class="math display">\[
|\psi_{0}\rangle=|0\rangle^{\otimes n}|1\rangle
\]</span></p>
<p><span class="math display">\[
H^{\otimes n}|x\rangle=\prod_{i=1}^{n}\frac{1}{\sqrt{2}}\sum_{y_{j}\in \{0,1\}}(-1)^{x_{i}y_{j}}|y_{j}\rangle=\frac{1}{2^{n/2}}\sum_{y=0}^{2^{n}-1}(-1)^{x\cdot y}|y\rangle
\]</span></p>
<p>其中，<span class="math inline">\(x\cdot y=x_{1}y_{1}\oplus x_{2}y_{2}\oplus\cdots\oplus x_{n}y_{n}\)</span></p>
<p><span class="math display">\[
H^{\otimes n}|0\rangle = \sum_{x=0}^{2^{n}-1}\frac{|x\rangle}{\sqrt{2^{n}}}
\]</span> 所以<span class="math inline">\(|\psi_{1}\rangle=\sum_{x=0}^{2^{n}-1}\frac{|x\rangle}{\sqrt{2^{n}}}\cdot\frac{|0\rangle -|1\rangle}{\sqrt{2}}\)</span></p>
<p>经过<span class="math inline">\(U_{f}\)</span>的作用后，<span class="math inline">\(x\)</span>保持不变，<span class="math inline">\(y\)</span>变为<span class="math inline">\(y\oplus f(x)\)</span>。因为<span class="math inline">\(y=\frac{|0\rangle -|1\rangle}{\sqrt{2}}\)</span>，所以<span class="math inline">\(y\oplus f(x)=\frac{1}{\sqrt{2}}(|f(x)\rangle-|1\oplus f(x)\rangle)\)</span>。当<span class="math inline">\(f(x)=0\)</span>时，<span class="math inline">\(y\oplus f(x)=\frac{1}{\sqrt{2}}(|0\rangle-|1\rangle)\)</span>；当<span class="math inline">\(f(x)=1\)</span>时，<span class="math inline">\(y\oplus f(x)=\frac{1}{\sqrt{2}}(|1\rangle-|0\rangle)=-\frac{1}{\sqrt{2}}(|0\rangle-|1\rangle)\)</span>。所以<span class="math inline">\(y\oplus f(x)=(-1)^{f(x)}|y\rangle\)</span>。</p>
<p>所以<span class="math inline">\(|\psi_{2}\rangle=\sum_{x=0}^{2^{n}-1}\frac{(-1)^{f(x)}}{\sqrt{2^{n}}}|x\rangle\cdot\frac{|0\rangle-|1\rangle}{\sqrt{2}}\)</span>。</p>
<p>再经过一次Hadamard变换，<span class="math inline">\(|\psi_{3}\rangle=\frac{1}{2^{n}}\sum_{x=0}^{2^{n}-1}(-1)^{f(x)}\sum_{y=0}^{2^{n}-1}(-1)^{x\cdot y}|y\rangle\cdot\frac{|0\rangle-|1\rangle}{\sqrt{2}}=\frac{1}{2^{n}}\sum_{x=0}^{2^{n}-1}\sum_{y=0}^{2^{n}-1}(-1)^{f(x)+x\cdot y}|y\rangle \cdot\frac{|0\rangle-|1\rangle}{\sqrt{2}}\)</span>。</p>
<p>然后只需测量上边部分，如果测量结果为<span class="math inline">\(|0\rangle^{\otimes n}\)</span>，则是常数函数，否则是对称函数。</p>
<span id="more"></span>
<p><strong>原理如下</strong>：</p>
<p>对于<span class="math inline">\(|\psi_{3}\rangle\)</span>，只考虑前n个qubit，则是<span class="math inline">\(\frac{1}{2^{n}}\sum_{x=0}^{2^{n}-1}\sum_{y=0}^{2^{n}-1}(-1)^{f(x)+x\cdot y}|y\rangle=\frac{1}{2^{n}}\sum_{x=0}^{2^{n}-1}(-1)^{f(x)}\sum_{y=0}^{2^{n}-1}(-1)^{x\cdot y}|y\rangle\)</span>。</p>
<p>当<span class="math inline">\(f(x)\)</span>是常数函数的时候，考虑<span class="math inline">\(y=0\)</span>的部分，<span class="math inline">\(x\cdot y=0,(-1)^{x\cdot y}=1\)</span>，所以其系数为<span class="math inline">\(\pm 1\)</span>。因为系数的平方的和为1，所以其他态的系数为0。或者对于<span class="math inline">\(y\neq 1\)</span>时，则<span class="math inline">\(y\)</span>至少有一位为1，不妨假设<span class="math inline">\(y_{i}=1\)</span>，当<span class="math inline">\(x\)</span>从0求和到<span class="math inline">\(2^{n}-1\)</span>时，有一半的<span class="math inline">\(x_{i}\)</span>为0，有一半<span class="math inline">\(x_{i}\)</span>为1。因为<span class="math inline">\((-1)^{a\oplus b}=(-1)^{a}\cdot (-1)^{b}\)</span>，所以<span class="math inline">\((-1)^{x_{i}\oplus y_{i}}\)</span>的和为0。当有多个<span class="math inline">\(y_{i}\)</span>为1时，也是同样道理。所以其前n个qubit为<span class="math inline">\(|0\rangle\)</span>。</p>
<p>当<span class="math inline">\(f(x)\)</span>是平衡函数时，由常数函数的情况可知，对于<span class="math inline">\(y=0\)</span>的部分，<span class="math inline">\(x\cdot y=0,(-1)^{x\cdot y}=1\)</span>，而因为<span class="math inline">\((-1)^{f(x)}\)</span>有一半为1，有一半为-1，所以其系数为0。所以对上边的输入进行测量不可能测量到<span class="math inline">\(|0\rangle ^{\otimes n}\)</span>。</p>
]]></content>
      <categories>
        <category>量子计算</category>
      </categories>
      <tags>
        <tag>Deutsch算法</tag>
        <tag>量子计算</tag>
      </tags>
  </entry>
  <entry>
    <title>量子傅里叶变换(QFT)</title>
    <url>/2019/10/06/quantum-fourier-transform/</url>
    <content><![CDATA[<h2 id="离散傅里叶变换dft">离散傅里叶变换(DFT)</h2>
<p>对于N点序列<span class="math inline">\(\{x[n]\},0\leq n&lt;N\)</span>，其DFT为：<span class="math inline">\(\hat{x}[k]=\sum_{n=0}^{N-1}e^{-i\frac{2\pi}{N}nk}x[n],k=0,1,\ldots,N-1\)</span>，记为<span class="math inline">\(\hat{x}=\mathcal{F}\{x\}\)</span>，其逆DFT为：<span class="math inline">\(x[n]=\frac{1}{N}\sum_{k=0}^{N-1}e^{i\frac{2\pi}{N}nk}\hat{x}[k],n=0,1,\ldots,N-1\)</span>，记为<span class="math inline">\(x=\mathcal{F}^{-1}\{\hat{x}\}\)</span>。</p>
<p>将DFT和逆DFT两个式子的两边分别乘<span class="math inline">\(\sqrt{N}\)</span>，得<span class="math inline">\((\sqrt{N}\hat{x}[k])=\sum_{n=0}^{N-1}e^{-i\frac{2\pi}{N}nk}(\sqrt{N}x[n]),k=0,1,\ldots,N-1\)</span>与<span class="math inline">\((\sqrt{N}x[n])=\frac{1}{N}\sum_{k=0}^{N-1}e^{i\frac{2\pi}{N}nk}(\sqrt{N}\hat{x}[k]),n=0,1,\ldots,N-1\)</span>。</p>
<p>整理可得：<span class="math inline">\(\hat{x}[k]=\frac{1}{\sqrt{N}}\sum_{n=0}^{N-1}e^{-i\frac{2\pi}{N}nk}(\sqrt{N}x[n]),k=0,1,\ldots,N-1\)</span>与<span class="math inline">\((\sqrt{N}x[n])=\frac{1}{\sqrt{N}}\sum_{k=0}^{N-1}e^{i\frac{2\pi}{N}nk}\hat{x}[k],n=0,1,\ldots,N-1\)</span>。</p>
<p>换元可得：逆DFT：<span class="math inline">\(x_{k}=\frac{1}{\sqrt{N}}\sum_{j=0}^{N-1}y_{j}e^{-2\pi ijk/N}\)</span>与DFT：<span class="math inline">\(y_{k}=\frac{1}{\sqrt{N}}\sum_{j=0}^{N-1}x_{j}e^{2\pi ijk/N}\)</span>，其中<span class="math inline">\(k=0,1,\ldots,N-1\)</span>。</p>
<h2 id="量子傅里叶变换qft">量子傅里叶变换(QFT)</h2>
<p>即用量子线路实现DFT：<span class="math inline">\(\hat{f}(k)=\frac{1}{\sqrt{N}}\sum_{j=0}^{N-1}f(j)e^{2\pi ijk/N},\, k=0,1,\ldots,N-1\)</span>。</p>
<p>用量子态表示DFT为：<span class="math inline">\(|\hat{\psi}\rangle=\mathcal{F}(|\psi\rangle),\, |\hat{\psi}\rangle=\sum_{k=0}^{2^{n}-1}\hat{f}(k)|k\rangle,\, |\psi\rangle=\sum_{j=0}^{2^{n}-1}f(j)|j\rangle,\, 2^{n}=N\)</span>。</p>
<p>若<span class="math inline">\(\mathcal{F}(|j\rangle)=\frac{1}{\sqrt{2^{n}}}\sum_{k=0}^{2^{n}-1}e^{2\pi ijk/2^{n}}|k\rangle\)</span>，则</p>
<p><span class="math display">\[
\begin{equation}
\begin{aligned}
|\hat{\psi}\rangle &amp; = \mathcal{F}(|\psi\rangle) \\
&amp; =\sum_{j=0}^{2^{n}-1}f(j)\mathcal{F}(|j\rangle) \\
&amp;=\frac{1}{\sqrt{2^{n}}}\sum_{j=0}^{2^{n-1}}f(j)\sum_{k=0}^{2^{n}-1}\exp(2\pi ijk/2^{n})|k\rangle \\
&amp; =\frac{1}{\sqrt{2^{n}}}\sum_{k=0}^{2^{n}-1}(\sum_{j=0}^{2^{n}-1}\exp(2\pi ijk/2^{n})f(j)) |k\rangle \\
&amp; =\sum_{k=0}^{2^{n}-1}\hat{f}(k)|k\rangle
\end{aligned}
\end{equation}
\]</span></p>
<p>所以QFT为：<span class="math inline">\(\mathcal{F}(|j\rangle)=\frac{1}{\sqrt{2^{n}}}\sum_{k=0}^{2^{n}-1}e^{2\pi ijk/2^{n}}|k\rangle\)</span>。</p>
<span id="more"></span>
<h2 id="qft的张量积形式">QFT的张量积形式</h2>
<p>首先定义<span class="math inline">\(j\)</span>的二进制表示，<span class="math inline">\(j=j_{n-1}j_{n-2}\ldots j_{0}=j_{n-1}2^{n-1}+j_{n-2}2^{n-2}+\ldots+j_{0}2^{0}\)</span>，对于小数来说，<span class="math inline">\(0.j_{l}j_{l+1}\ldots j_{m}=\frac{1}{2}j_{l}+\frac{1}{2^{2}}j_{l+1}+\ldots +\frac{1}{2^{m-l+1}}j_{m}\)</span>。</p>
<p><span class="math display">\[
\begin{equation}
\begin{aligned}
\mathcal{F}(|j\rangle) &amp; =\frac{1}{\sqrt{2^{n}}}\sum_{k=0}^{2^{n}-1}e^{2\pi ijk/2^{n}}|k\rangle \\
&amp; =\frac{1}{\sqrt{2^{n}}}\sum_{k_{n-1}=0}^{1}\ldots\sum_{k_{0}=0}^{1}\exp(2\pi ij\sum_{l=1}^{n}\frac{k_{n-l}}{2^{l}})|k_{n-1}\ldots k_{0}\rangle \\
&amp; =\frac{1}{\sqrt{2^{n}}}\sum_{k_{n-1}=0}^{1}\ldots\sum_{k_{0}=0}^{1}\otimes_{l=1}^{n}\exp(2\pi ij\frac{k_{n-l}}{2^{l}})|k_{n-l}\rangle \\
&amp; =\frac{1}{\sqrt{2^{n}}}\otimes_{l=1}^{n}[\sum_{k_{n-l}=0}^{1}\exp(2\pi ij\frac{k_{n-l}}{2^{l}})|k_{n-l}\rangle] \\
&amp; =\frac{1}{\sqrt{2^{n}}}\otimes_{l=1}^{n}[|0\rangle+\exp(2\pi ij\frac{1}{2^{l}})|1\rangle] \\
&amp; =\frac{1}{\sqrt{2^{n}}}(|0\rangle+e^{2\pi i0.j_{0}}|1\rangle)\otimes(|0\rangle+e^{2\pi i0.j_{1}j_{0}}|1\rangle)\otimes\ldots\otimes(|0\rangle+e^{2\pi i0.j_{n-1}j_{n-2}\ldots j_{0}}|1\rangle)
\end{aligned}
\end{equation}
\]</span></p>
<p>所以QFT的张量积形式为：<span class="math inline">\(\frac{1}{\sqrt{2^{n}}}(|0\rangle+e^{2\pi i0.j_{0}}|1\rangle)\otimes(|0\rangle+e^{2\pi i0.j_{1}j_{0}}|1\rangle)\otimes\ldots\otimes(|0\rangle+e^{2\pi i0.j_{n-1}j_{n-2}\ldots j_{0}}|1\rangle)\)</span>。</p>
<p>解释推导过程的两个问题：</p>
<ol type="1">
<li><span class="math inline">\(\otimes\)</span>本质是一个连乘的符号，所以可以与<span class="math inline">\(\sum\)</span>调换位置。</li>
<li>推导过程中，第五行到第六行。因为<span class="math inline">\(j\frac{1}{2^{l}}=j_{n-1}\ldots j_{l+1}.j_{l}\ldots j_{0}\)</span>，<span class="math inline">\(\exp(2\pi ij\frac{1}{2^{l}})=\exp(2\pi ij_{n-1}\ldots j_{l+1})*\exp(2\pi i0.j_{l}\ldots j_{0})\)</span>，即把<span class="math inline">\(j\)</span>拆分为整数部分和小数部分，整数部分是1，所以可以省略，只有小数部分有效。</li>
</ol>
<h2 id="qft的量子线路模型">QFT的量子线路模型</h2>
<p>假设一个量子门<span class="math inline">\(R_{k}=\begin{bmatrix}1&amp;0\\0&amp;\exp(\frac{2\pi i}{2^{k}})\end{bmatrix}\)</span>，显然<span class="math inline">\(R_{k}\)</span>是一个酉变换。</p>
<p><img src="/2019/10/06/quantum-fourier-transform/circuit-of-qft.jpg"></p>
<p>首先，有<span class="math inline">\(e^{2\pi i0,j_{0}}=e^{\pi ij_{0}}=\left\{\begin{array}{ll}1&amp;j_{0}=0\\-1&amp;j_{0}=1\end{array} \right.\)</span>，所以<span class="math inline">\(|0\rangle+e^{2\pi i0,j_{0}}|1\rangle=\left\{\begin{array}{ll}|0\rangle+|1\rangle&amp;j_{0}=0\\|0\rangle-|1\rangle&amp;j_{0}=1\end{array} \right.\)</span>，所以用H门即可实现这个变换。</p>
<p>接下来，<span class="math inline">\(e^{2\pi i0.j_{x}\ldots j_{0}}=e^{2\pi i0.j_{x}}*e^{2\pi i0.0j_{x-1}\ldots j_{0}}\)</span>，可以看出，这一项只与前x个量子位有关。对于<span class="math inline">\(e^{2\pi i0.j_{x}}\)</span>，如前文所述，用H门可以实现，对于<span class="math inline">\(e^{2\pi i0.0j_{x-1}\ldots j_{0}}\)</span>，使用受控<span class="math inline">\(R_{k}\)</span>门即可得到<span class="math inline">\(j_{k}\)</span>，所以整体线路模型如上图所示。</p>
<p>QFT量子线路的latex代码为：</p>
<pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">&#123;</span><span class="token keyword">article</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\usepackage</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>qcircuit<span class="token punctuation">&#125;</span>
<span class="token function selector">\newcommand</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#125;</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token function selector">\ensuremath</span><span class="token punctuation">&#123;</span><span class="token function selector">\left</span><span class="token function selector">\vert</span> #1 <span class="token function selector">\right</span><span class="token function selector">\rangle</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\newcommand</span><span class="token punctuation">&#123;</span><span class="token function selector">\bra</span><span class="token punctuation">&#125;</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token function selector">\ensuremath</span><span class="token punctuation">&#123;</span><span class="token function selector">\left</span><span class="token function selector">\langle</span><span class="token punctuation">&#123;</span>#1<span class="token punctuation">&#125;</span><span class="token function selector">\right</span><span class="token function selector">\vert</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\begin</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span>
	<span class="token function selector">\Qcircuit</span>@C=0.7em@R=0.7em <span class="token punctuation">&#123;</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>j_<span class="token punctuation">&#123;</span>n-1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_<span class="token punctuation">&#123;</span>2<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_<span class="token punctuation">&#123;</span>n-1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_n<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span>+e^<span class="token punctuation">&#123;</span>2<span class="token function selector">\pi</span> i0.j_<span class="token punctuation">&#123;</span>n-1<span class="token punctuation">&#125;</span><span class="token function selector">\ldots</span> j_<span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>j_<span class="token punctuation">&#123;</span>n-2<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-1<span class="token punctuation">&#125;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>       <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_<span class="token punctuation">&#123;</span>n-2<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_<span class="token punctuation">&#123;</span>n-1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span>+e^<span class="token punctuation">&#123;</span>2<span class="token function selector">\pi</span> i0.j_<span class="token punctuation">&#123;</span>n-2<span class="token punctuation">&#125;</span><span class="token function selector">\ldots</span> j_<span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\vdots</span><span class="token punctuation">&#125;</span>       <span class="token punctuation">&amp;</span>        <span class="token punctuation">&amp;</span>            <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\ddots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>              <span class="token punctuation">&amp;</span>          <span class="token punctuation">&amp;</span>        <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\ddots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>              <span class="token punctuation">&amp;</span>              <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>      <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>        <span class="token punctuation">&amp;</span>              <span class="token punctuation">&amp;</span>        <span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\vdots</span><span class="token punctuation">&#125;</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>j_<span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>  <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>         <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-3<span class="token punctuation">&#125;</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>       <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-2<span class="token punctuation">&#125;</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_<span class="token punctuation">&#123;</span>n-2<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span>+e^<span class="token punctuation">&#123;</span>2<span class="token function selector">\pi</span> i0.j_<span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span>j_<span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>j_<span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>  <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>         <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-4<span class="token punctuation">&#125;</span> <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-3<span class="token punctuation">&#125;</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-1<span class="token punctuation">&#125;</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span>+e^<span class="token punctuation">&#123;</span>2<span class="token function selector">\pi</span> i0.j_<span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span>
	<span class="token punctuation">&#125;</span>
<span class="token function selector">\end</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
]]></content>
      <categories>
        <category>量子计算</category>
      </categories>
      <tags>
        <tag>量子计算</tag>
        <tag>QFT</tag>
      </tags>
  </entry>
  <entry>
    <title>HHL算法(量子求解线性方程组)</title>
    <url>/2019/10/06/quantum-hhl-algorithm/</url>
    <content><![CDATA[<h2 id="hhl算法的目标">HHL算法的目标</h2>
<p>求解<span class="math inline">\(A\vec{x}=\vec{b}\)</span>，其中<span class="math inline">\(A\)</span>是<span class="math inline">\(n\times n\)</span>的方阵，<span class="math inline">\(\vec{x}\)</span>和<span class="math inline">\(\vec{b}\)</span>都是<span class="math inline">\(n\times1\)</span>的向量。假设矩阵<span class="math inline">\(A\)</span>是厄密的（即<span class="math inline">\(A^{\dagger}=A\)</span>），则矩阵<span class="math inline">\(e^{iAt}\)</span>是酉的（即<span class="math inline">\(AA^{\dagger}=A^{\dagger}A=I\)</span>），同时<span class="math inline">\(A\)</span>和<span class="math inline">\(e^{iAt}\)</span>有相同的特征向量，若<span class="math inline">\(A|u\rangle=\lambda|u\rangle\)</span>，则<span class="math inline">\(e^{iAt}|u\rangle=e^{i\lambda t}|u\rangle\)</span>。本问题中，还需假设<span class="math inline">\(\|\vec{x}\|=1,\|\vec{b}\|=1\)</span>。因为<span class="math inline">\(e^{iAt}\)</span>是酉矩阵，所以它有<span class="math inline">\(n\)</span>个相互正交的特征向量。本问题中，将问题变形为<span class="math inline">\(A|x\rangle=|b\rangle\)</span>，并不完全等同于原问题。</p>
<p>很多地方笔者并没有完全搞懂，故省略了很多推导过程和证明，后面可能会补充。</p>
<h2 id="hhl算法的量子线路图">HHL算法的量子线路图</h2>
<p><img src="/2019/10/06/quantum-hhl-algorithm/circuit-of-hhl-algorithm.png"></p>
<p>其对应的latex代码为：</p>
<pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">&#123;</span><span class="token keyword">article</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\usepackage</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>qcircuit<span class="token punctuation">&#125;</span>
<span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">ifpdf</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\xyoption</span><span class="token punctuation">&#123;</span>all<span class="token punctuation">&#125;</span>
<span class="token function selector">\newcommand</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#125;</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token function selector">\ensuremath</span><span class="token punctuation">&#123;</span><span class="token function selector">\left</span><span class="token function selector">\vert</span> #1 <span class="token function selector">\right</span><span class="token function selector">\rangle</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\newcommand</span><span class="token punctuation">&#123;</span><span class="token function selector">\bra</span><span class="token punctuation">&#125;</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token function selector">\ensuremath</span><span class="token punctuation">&#123;</span><span class="token function selector">\left</span><span class="token function selector">\langle</span><span class="token punctuation">&#123;</span>#1<span class="token punctuation">&#125;</span><span class="token function selector">\right</span><span class="token function selector">\vert</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\begin</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span>
	<span class="token function selector">\Qcircuit</span>@C=0.7em@R=0.7em <span class="token punctuation">&#123;</span>
		<span class="token punctuation">&amp;</span>          <span class="token punctuation">&amp;</span>                        <span class="token punctuation">&amp;</span>        <span class="token punctuation">&amp;</span>                   <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>         <span class="token punctuation">&amp;</span><span class="token function selector">\mbox</span><span class="token punctuation">&#123;</span>Controlled Rotation<span class="token punctuation">&#125;</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span>Ancilla <span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>       <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>                 <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>                <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R<span class="token punctuation">&#125;</span> <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>      <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>                 <span class="token punctuation">&amp;</span><span class="token function selector">\meter</span><span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span>EigenValue <span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&#123;</span>/^<span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H^<span class="token punctuation">&#123;</span><span class="token function selector">\otimes</span> n<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>FT^<span class="token punctuation">&#123;</span><span class="token function selector">\dagger</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-1<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>FT<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H^<span class="token punctuation">&#123;</span><span class="token function selector">\otimes</span> n<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0^<span class="token punctuation">&#123;</span><span class="token function selector">\otimes</span> n<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span>Input <span class="token function selector">\ket</span><span class="token punctuation">&#123;</span><span class="token function selector">\psi</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>  <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&#123;</span>/^<span class="token punctuation">&#123;</span>m<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>                 <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>U<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>                <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>      <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>      <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>U<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span><span class="token function selector">\hat</span><span class="token punctuation">&#123;</span>x<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span> 
		<span class="token function selector">\gategroup</span><span class="token punctuation">&#123;</span>3<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>4<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>4<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>6<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>.7em<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>--<span class="token punctuation">&#125;</span>  <span class="token function selector">\gategroup</span><span class="token punctuation">&#123;</span>2<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>8<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>3<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>8<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>.7em<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>--<span class="token punctuation">&#125;</span> <span class="token function selector">\gategroup</span><span class="token punctuation">&#123;</span>3<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>10<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>4<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>12<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>.7em<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>--<span class="token punctuation">&#125;</span><span class="token function selector">\\</span>
		<span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token function selector">\mbox</span><span class="token punctuation">&#123;</span>Phase Estimation<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token function selector">\mbox</span><span class="token punctuation">&#123;</span>Inverse Phase Estimation<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token function selector">\end</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<span id="more"></span>
<h2 id="hhl的算法解释">HHL的算法解释</h2>
<p>第一步：相位估计(Phase Estimation)</p>
<p>首先，有<span class="math inline">\(|b\rangle=\sum_{i=0}^{N-1}b_{i}|i\rangle=\sum_{i=0}^{N-1}\beta_{i}|\mu_{i}\rangle\)</span>，其中<span class="math inline">\(\mu_{i}\)</span>是<span class="math inline">\(A\)</span>（和<span class="math inline">\(e^{iAt}\)</span>）的特征向量。然后，因为<span class="math inline">\(U=e^{iAt}\)</span>是酉的，故可以用Hamiltonian simulation来制备<span class="math inline">\(U\)</span>门。</p>
<p>相位估计的电路图和功能如下：</p>
<p><img src="/2019/10/06/quantum-hhl-algorithm/gate-of-phase-estimation.png"></p>
<p>其对应的latex代码为：</p>
<pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">&#123;</span><span class="token keyword">article</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\usepackage</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>qcircuit<span class="token punctuation">&#125;</span>
<span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">ifpdf</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\xyoption</span><span class="token punctuation">&#123;</span>all<span class="token punctuation">&#125;</span>
<span class="token function selector">\newcommand</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#125;</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token function selector">\ensuremath</span><span class="token punctuation">&#123;</span><span class="token function selector">\left</span><span class="token function selector">\vert</span> #1 <span class="token function selector">\right</span><span class="token function selector">\rangle</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\newcommand</span><span class="token punctuation">&#123;</span><span class="token function selector">\bra</span><span class="token punctuation">&#125;</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token function selector">\ensuremath</span><span class="token punctuation">&#123;</span><span class="token function selector">\left</span><span class="token function selector">\langle</span><span class="token punctuation">&#123;</span>#1<span class="token punctuation">&#125;</span><span class="token function selector">\right</span><span class="token function selector">\vert</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\begin</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span>
	<span class="token function selector">\Qcircuit</span>@C=0.7em@R=0.7em <span class="token punctuation">&#123;</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&#123;</span>/^<span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\multigate</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>PE_<span class="token punctuation">&#123;</span>U<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>2^<span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span><span class="token function selector">\theta</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span><span class="token function selector">\psi</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&#123;</span>/^<span class="token punctuation">&#123;</span>m<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\ghost</span><span class="token punctuation">&#123;</span>PE_<span class="token punctuation">&#123;</span>U<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>       <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span><span class="token function selector">\psi</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span> 
	<span class="token punctuation">&#125;</span>
<span class="token function selector">\end</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>具体的实现方式见我的另一篇文章。</p>
<p>相位估计中，<span class="math inline">\(|\psi\rangle\)</span>是<span class="math inline">\(U\)</span>的特征向量，<span class="math inline">\(U|\psi\rangle=e^{2\pi i\theta}|\psi\rangle\)</span>。输出得到<span class="math inline">\(|2^{n}\theta\rangle\)</span>。本文中，<span class="math inline">\(U=e^{iAt}\)</span>，若<span class="math inline">\(A|\psi\rangle=\lambda|\psi\rangle\)</span>，则<span class="math inline">\(U|\psi\rangle=e^{i\lambda t}|\psi\rangle\)</span>。因此，在相位估计后，若Eigenvalue的值变为<span class="math inline">\(|\hat{\lambda}\rangle\)</span>，则<span class="math inline">\(\hat{\lambda}=2^{n}\frac{\lambda t}{2\pi}\)</span>。因此<span class="math inline">\(\hat{\lambda}\)</span>与<span class="math inline">\(\lambda\)</span>是正比关系。后面就认为<span class="math inline">\(\hat{\lambda}\)</span>是对<span class="math inline">\(\lambda\)</span>的估计。</p>
<p>相位估计之前，<span class="math inline">\(|\psi\rangle=\sum_{i=0}^{N-1}\beta_{i}|\mu_{i}\rangle\)</span>，因此相位估计后，Input与Eigenvalue变为<span class="math inline">\(\sum_{j=0}^{N-1}\beta_{j}|\mu_{j}\rangle|\lambda_{j}\rangle\)</span>。</p>
<p>第二步：受控旋转，所有的Qubits变为<span class="math inline">\(\sum_{j=0}^{N-1}\beta_{j}|\mu_{j}\rangle|\lambda_{j}\rangle(\sqrt{1-\frac{C^{2}}{\lambda_{j}}}|0\rangle+\frac{C}{\lambda}|1\rangle)\)</span>。</p>
<p>第三步：逆相位估计，得到<span class="math inline">\(\sum_{j=0}^{N-1}\beta_{j}|\mu_{j}\rangle|0\rangle(\sqrt{1-\frac{C^{2}}{\lambda_{j}}}|0\rangle+\frac{C}{\lambda}|1\rangle)\)</span></p>
<p>第四步：对Ancilla进行测量，当得到<span class="math inline">\(|1\rangle\)</span>的时候，Input变为<span class="math inline">\(|\hat{x}\rangle=\frac{1}{N_{x&#39;}}\sum_{j=0}^{N-1}\frac{C}{\lambda_{j}}\beta_{j}|\mu_{j}\rangle\)</span>，与我们想要的<span class="math inline">\(|x\rangle=\sum_{j=0}^{N-1}\beta_{j}\frac{1}{\lambda_{j}}|\mu_{j}\rangle\)</span>成正比关系，故相当于得到了<span class="math inline">\(|x\rangle\)</span>。</p>
<h2 id="相关证明">相关证明</h2>
<ol type="1">
<li><span class="math inline">\(A\)</span>是厄密矩阵，所以<span class="math inline">\(A\)</span>有<span class="math inline">\(n\)</span>个相互正交的特征向量，证明<span class="math inline">\(e^{iAt}\)</span>是酉矩阵。因为A是Hermitian矩阵，所以存在酉矩阵<span class="math inline">\(U\)</span>，使得<span class="math inline">\(D=U^{\dagger}AU\)</span>为实对角阵。由矩阵级数的定义可知，<span class="math inline">\(U^{\dagger}e^{iA}U=e^{iU^{\dagger}AU}=e^{iD}\)</span>，因为<span class="math inline">\(D\)</span>是实对角阵，所以<span class="math inline">\(e^{iD}\)</span>也是实对角阵，特征值形如<span class="math inline">\(e^{i\lambda}\)</span>，其中<span class="math inline">\(\lambda\)</span>是实数（<span class="math inline">\(D\)</span>的对角元，<span class="math inline">\(A\)</span>的特征值）。由欧拉公式可得<span class="math inline">\(e^{i\lambda}=\cos\lambda+i\sin\lambda\)</span>，其复共轭为<span class="math inline">\(\cos\lambda-i\sin\lambda=e^{-i\lambda}\)</span>，所以<span class="math inline">\(e^{iD}\times e^{-iD}=E\)</span>，所以<span class="math inline">\(e^{iD}\)</span>是酉矩阵。所以<span class="math inline">\(e^{iA}=Ue^{iD}U^{\dagger}\)</span>也是酉矩阵。</li>
</ol>
<h2 id="参考资料">参考资料</h2>
<ol type="1">
<li><a href="https://zhidao.baidu.com/question/513908090.html">https://zhidao.baidu.com/question/513908090.html</a></li>
<li><a href="https://arxiv.org/abs/0811.3171v3">https://arxiv.org/abs/0811.3171v3</a></li>
</ol>
]]></content>
      <categories>
        <category>量子计算</category>
      </categories>
      <tags>
        <tag>量子计算</tag>
        <tag>QFT</tag>
        <tag>量子机器学习</tag>
      </tags>
  </entry>
  <entry>
    <title>量子相位估计算法</title>
    <url>/2019/10/06/quantum-phase-estimation/</url>
    <content><![CDATA[<h1 id="相位估计算法quantum-phase-estimation">相位估计算法(Quantum phase estimation)</h1>
<h2 id="量子逆傅里叶变换逆qft">量子逆傅里叶变换(逆QFT)</h2>
<p>数学形式：<span class="math inline">\(f(j)=\frac{1}{\sqrt{N}}\sum_{k=0}^{N-1}\hat{f}(k)\exp(-2\pi ijk/N),\, j=0,1,\ldots,N-1\)</span></p>
<p>量子态形式：<span class="math inline">\(|\psi\rangle=\mathcal{F}^{-1}(|\hat{\psi}\rangle),\, |\hat{\psi}\rangle=\sum_{k=0}^{2^{n}-1}\hat{f}(k)|k\rangle,\, |\psi\rangle=\sum_{j=0}^{2^{n}-1}f(j)|j\rangle,\, 2^{n}=N\)</span></p>
<p>若<span class="math inline">\(\mathcal{F}^{-1}(|k\rangle)=\frac{1}{\sqrt{2^{n}}}\sum_{j=0}^{2^{n}-1}\exp(-2\pi ijk/2^{n})|j\rangle\)</span>，则 <span class="math display">\[
\begin{equation}
\begin{aligned}
|\psi\rangle &amp; =\mathcal{F}^{-1}(|\hat{\psi}\rangle) \\
&amp; =\sum_{k=0}^{2^{n}-1}\hat{f}(k)\mathcal{F}^{-1}(|k\rangle) \\
&amp; =\frac{1}{\sqrt{2^{n}}}\sum_{k=0}^{2^{n}-1}\hat{f}(k)\sum_{j=0}^{2^{n}-1}\exp(-2\pi ijk/2^{n})|j\rangle \\
&amp; =\frac{1}{\sqrt{2^{n}}}\sum_{j=0}^{2^{n}-1}(\sum_{k=0}^{2^{n}-1}\hat{f}(k)\exp(-2\pi ijk/2^{n}))|j\rangle \\
&amp; =\sum_{j=0}^{2^{n}-1}f(j)|j\rangle
\end{aligned}
\end{equation}
\]</span></p>
<p>所以，逆QFT为：<span class="math inline">\(\mathcal{F}^{-1}(|k\rangle)=\frac{1}{\sqrt{2^{n}}}\sum_{j=0}^{2^{n}-1}\exp(-2\pi ijk/2^{n})|j\rangle\)</span></p>
<span id="more"></span>
<h2 id="逆qft的张量积形式">逆QFT的张量积形式</h2>
<p>定义<span class="math inline">\(k\)</span>的二进制表示，<span class="math inline">\(k=k_{n-1}k_{n-2}\ldots k_{0}=k_{n-1}2^{n-1}+k_{n-2}2^{n-2}+\ldots +k_{0}2^{0}\)</span>，对于小数来说，<span class="math inline">\(0.k_{l}k_{l+1}\ldots k_{m}=\frac{1}{2}k_{l}+\frac{1}{2^{2}}k_{l+1}+\ldots +\frac{1}{2^{m-l+1}}k_{m}\)</span>。 <span class="math display">\[
\begin{equation}
\begin{aligned}
\mathcal{F}^{-1}(|k\rangle)&amp; =\frac{1}{\sqrt{2^{n}}}\sum_{j=0}^{2^{n}-1}\exp(-2\pi ijk/2^{n})|j\rangle \\
&amp; =\frac{1}{\sqrt{2^{n}}}\sum_{j_{n-1}=0}^{1}\ldots\sum_{j_{0}=0}^{1}\exp(-2\pi ik\sum_{l=1}^{n}\frac{j_{n-l}}{2^{l}})|j_{n-1}\ldots j_{0}\rangle \\
&amp; =\frac{1}{\sqrt{2^{n}}}\sum_{j_{n-1}=0}^{1}\ldots\sum_{j_{0}=0}^{1}\otimes_{l=1}^{n}\exp(-2\pi ik\frac{j_{n-l}}{2^{l}})|j_{n-l}\rangle \\
&amp; =\frac{1}{\sqrt{2^{n}}}\otimes_{l=1}^{n}[\sum_{j_{n-l}=0}^{1}\exp(-2\pi ik\frac{j_{n-l}}{2^{l}})|j_{n-l}\rangle] \\
&amp; =\frac{1}{\sqrt{2^{n}}}\otimes_{l=1}^{n}[|0\rangle+\exp(-2\pi ik\frac{1}{2^{l}})|1\rangle] \\
&amp; =\frac{1}{\sqrt{2^{n}}}(|0\rangle+e^{-2\pi i0.k_{0}}|1\rangle)\otimes(|0\rangle+e^{-2\pi i0.k_{1}k_{0}}|1\rangle)\otimes\ldots\otimes(|0\rangle+e^{-2\pi i0.k_{n-1}k_{n-2}\ldots k_{0}}|1\rangle)
\end{aligned}
\end{equation}
\]</span></p>
<h2 id="逆qft的量子线路模型">逆QFT的量子线路模型</h2>
<p>假设量子门<span class="math inline">\(R_{k}^{\dagger}=\begin{bmatrix}1&amp;0\\0&amp;\exp(\frac{-2\pi i}{2^{k}})\end{bmatrix}\)</span>，与QFT类似可得逆QFT的量子线路图。</p>
<p><img src="/2019/10/06/quantum-phase-estimation/circuit-of-inverse-qft.jpg"></p>
<p>其latex代码为：</p>
<pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">&#123;</span><span class="token keyword">article</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\usepackage</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>qcircuit<span class="token punctuation">&#125;</span>
<span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">ifpdf</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\xyoption</span><span class="token punctuation">&#123;</span>all<span class="token punctuation">&#125;</span>
<span class="token function selector">\newcommand</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#125;</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token function selector">\ensuremath</span><span class="token punctuation">&#123;</span><span class="token function selector">\left</span><span class="token function selector">\vert</span> #1 <span class="token function selector">\right</span><span class="token function selector">\rangle</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\newcommand</span><span class="token punctuation">&#123;</span><span class="token function selector">\bra</span><span class="token punctuation">&#125;</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token function selector">\ensuremath</span><span class="token punctuation">&#123;</span><span class="token function selector">\left</span><span class="token function selector">\langle</span><span class="token punctuation">&#123;</span>#1<span class="token punctuation">&#125;</span><span class="token function selector">\right</span><span class="token function selector">\vert</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\begin</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span>
	<span class="token function selector">\Qcircuit</span>@C=0.7em@R=0.7em <span class="token punctuation">&#123;</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>k_<span class="token punctuation">&#123;</span>n-1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_<span class="token punctuation">&#123;</span>2<span class="token punctuation">&#125;</span>^<span class="token punctuation">&#123;</span><span class="token function selector">\dagger</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_<span class="token punctuation">&#123;</span>n-1<span class="token punctuation">&#125;</span>^<span class="token punctuation">&#123;</span><span class="token function selector">\dagger</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_<span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span>^<span class="token punctuation">&#123;</span><span class="token function selector">\dagger</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span>+e^<span class="token punctuation">&#123;</span>2<span class="token function selector">\pi</span> i0.k_<span class="token punctuation">&#123;</span>n-1<span class="token punctuation">&#125;</span><span class="token function selector">\ldots</span> k_<span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>k_<span class="token punctuation">&#123;</span>n-2<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-1<span class="token punctuation">&#125;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>       <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_<span class="token punctuation">&#123;</span>n-2<span class="token punctuation">&#125;</span>^<span class="token punctuation">&#123;</span><span class="token function selector">\dagger</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_<span class="token punctuation">&#123;</span>n-1<span class="token punctuation">&#125;</span>^<span class="token punctuation">&#123;</span><span class="token function selector">\dagger</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span>+e^<span class="token punctuation">&#123;</span>2<span class="token function selector">\pi</span> i0.k_<span class="token punctuation">&#123;</span>n-2<span class="token punctuation">&#125;</span><span class="token function selector">\ldots</span> k_<span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\vdots</span><span class="token punctuation">&#125;</span>       <span class="token punctuation">&amp;</span>        <span class="token punctuation">&amp;</span>            <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\ddots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>              <span class="token punctuation">&amp;</span>          <span class="token punctuation">&amp;</span>        <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\ddots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>              <span class="token punctuation">&amp;</span>              <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>      <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>        <span class="token punctuation">&amp;</span>              <span class="token punctuation">&amp;</span>        <span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\vdots</span><span class="token punctuation">&#125;</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>k_<span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>  <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>         <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-3<span class="token punctuation">&#125;</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>       <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-2<span class="token punctuation">&#125;</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>R_<span class="token punctuation">&#123;</span>2<span class="token punctuation">&#125;</span>^<span class="token punctuation">&#123;</span><span class="token function selector">\dagger</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span>+e^<span class="token punctuation">&#123;</span>2<span class="token function selector">\pi</span> i0.k_<span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span>k_<span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>k_<span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>  <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>         <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-4<span class="token punctuation">&#125;</span> <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>           <span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-3<span class="token punctuation">&#125;</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>-1<span class="token punctuation">&#125;</span>     <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H<span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\rstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span>+e^<span class="token punctuation">&#123;</span>2<span class="token function selector">\pi</span> i0.k_<span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\qw</span>
	<span class="token punctuation">&#125;</span>
<span class="token function selector">\end</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="量子相位估计">量子相位估计</h2>
<p>假设某一酉算符<span class="math inline">\(U\)</span>，它的本征态是<span class="math inline">\(|\psi\rangle\)</span>，且<span class="math inline">\(U|\psi\rangle=\lambda|\psi\rangle\)</span>，即<span class="math inline">\(|\psi\rangle\)</span>对应的本征值是<span class="math inline">\(\lambda\)</span>。量子相位估计即是估计<span class="math inline">\(\lambda\)</span>，不妨假设<span class="math inline">\(\lambda=\exp 2\pi i\theta\)</span>，估计<span class="math inline">\(\theta\)</span>即可估计<span class="math inline">\(\lambda\)</span>。由于<span class="math inline">\(U^{\dagger}U=I\)</span>（<span class="math inline">\(U\)</span>是酉矩阵），所以<span class="math inline">\(\langle\psi|U^{\dagger}U|\psi\rangle=\langle\psi|\psi\rangle\)</span>，<span class="math inline">\(\langle\psi|U^{\dagger}U|\psi\rangle=\langle\psi|\lambda^{*}\lambda|\psi\rangle=|\lambda|^{2}\langle\psi|\psi\rangle\)</span>，所以<span class="math inline">\(|\lambda|^{2}=1\)</span>。故可设<span class="math inline">\(\lambda=\exp(2\pi i\theta),0\leq\theta&lt;1\)</span>，所以，通过估计<span class="math inline">\(\theta\)</span>即可估计<span class="math inline">\(\lambda\)</span>。</p>
<p>其线路模型如下：</p>
<p><img src="/2019/10/06/quantum-phase-estimation/circuit-of-phase-estimation.png"></p>
<p>对应latex代码为：</p>
<pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">&#123;</span><span class="token keyword">article</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\usepackage</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>qcircuit<span class="token punctuation">&#125;</span>
<span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">ifpdf</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\xyoption</span><span class="token punctuation">&#123;</span>all<span class="token punctuation">&#125;</span>
<span class="token function selector">\newcommand</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#125;</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token function selector">\ensuremath</span><span class="token punctuation">&#123;</span><span class="token function selector">\left</span><span class="token function selector">\vert</span> #1 <span class="token function selector">\right</span><span class="token function selector">\rangle</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\newcommand</span><span class="token punctuation">&#123;</span><span class="token function selector">\bra</span><span class="token punctuation">&#125;</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token function selector">\ensuremath</span><span class="token punctuation">&#123;</span><span class="token function selector">\left</span><span class="token function selector">\langle</span><span class="token punctuation">&#123;</span>#1<span class="token punctuation">&#125;</span><span class="token function selector">\right</span><span class="token function selector">\vert</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token function selector">\begin</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span>
	<span class="token function selector">\Qcircuit</span>@C=0.7em@R=0.7em <span class="token punctuation">&#123;</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H<span class="token punctuation">&#125;</span>  <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>             <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>             <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>7<span class="token punctuation">&#125;</span>          <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\multigate</span><span class="token punctuation">&#123;</span>4<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token function selector">\mathcal</span><span class="token punctuation">&#123;</span>QFT<span class="token punctuation">&#125;</span>_<span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span>^<span class="token punctuation">&#123;</span>-1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\meter</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span> <span class="token function selector">\\</span>
		<span class="token function selector">\vdots</span>             <span class="token punctuation">&amp;</span>          <span class="token punctuation">&amp;</span>                <span class="token punctuation">&amp;</span>                <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>      <span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span>                  <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>                                     <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\vdots</span> <span class="token function selector">\\</span>
		<span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H<span class="token punctuation">&#125;</span>  <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>             <span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>4<span class="token punctuation">&#125;</span>        <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>               <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\ghost</span><span class="token punctuation">&#123;</span><span class="token function selector">\mathcal</span><span class="token punctuation">&#123;</span>QFT<span class="token punctuation">&#125;</span>_<span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span>^<span class="token punctuation">&#123;</span>-1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>       <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\meter</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span> <span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>   <span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>H<span class="token punctuation">&#125;</span>  <span class="token punctuation">&amp;</span><span class="token function selector">\ctrl</span><span class="token punctuation">&#123;</span>3<span class="token punctuation">&#125;</span>        <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>             <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>               <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\ghost</span><span class="token punctuation">&#123;</span><span class="token function selector">\mathcal</span><span class="token punctuation">&#123;</span>QFT<span class="token punctuation">&#125;</span>_<span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span>^<span class="token punctuation">&#123;</span>-1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>       <span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\meter</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span> <span class="token function selector">\\</span>
		<span class="token function selector">\\</span>
		<span class="token function selector">\\</span>
		<span class="token function selector">\lstick</span><span class="token punctuation">&#123;</span><span class="token function selector">\ket</span><span class="token punctuation">&#123;</span><span class="token function selector">\psi</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&#123;</span>/^<span class="token punctuation">&#123;</span>m<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>U^<span class="token punctuation">&#123;</span>2^<span class="token punctuation">&#123;</span>0<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>U^<span class="token punctuation">&#123;</span>2^<span class="token punctuation">&#123;</span>1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\cdots</span><span class="token punctuation">&amp;</span><span class="token punctuation">&amp;</span><span class="token function selector">\gate</span><span class="token punctuation">&#123;</span>U^<span class="token punctuation">&#123;</span>2^<span class="token punctuation">&#123;</span>n-1<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span><span class="token punctuation">&amp;</span><span class="token function selector">\qw</span>
	<span class="token punctuation">&#125;</span>
<span class="token function selector">\end</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>首先假设<span class="math inline">\(|\psi\rangle\)</span>包含<span class="math inline">\(m\)</span>个量子比特，上半部分初始为<span class="math inline">\(n\)</span>个状态为<span class="math inline">\(|0\rangle\)</span>的量子比特。</p>
<p>这<span class="math inline">\(n\)</span>个量子比特分别经过H门后变为<span class="math inline">\(\frac{1}{\sqrt{2^{n}}}(|0\rangle+|1\rangle)^{\otimes n}\)</span>。</p>
<p>对于<span class="math inline">\(U\)</span>门，因为<span class="math inline">\(U|\psi\rangle=\exp(2\pi i\theta)|\psi\rangle\)</span>，所以<span class="math inline">\(U^{2^{j}}|\psi\rangle=U^{2^{j}-1}U|\psi\rangle=U^{2^{j}-1}e^{2\pi i\theta}|\psi\rangle=e^{2\pi i2^{j}\theta}|\psi\rangle\)</span>。</p>
<p>当<span class="math inline">\(C-U^{2^{j}}\)</span>作用在<span class="math inline">\(\frac{1}{\sqrt{2}}(|0\rangle+|1\rangle)\otimes|\psi\rangle\)</span>上后，该量子态变为<span class="math inline">\(\frac{1}{\sqrt{2}}(|0\rangle\otimes|\psi\rangle+e^{2\pi i2^{j}\theta}|1\rangle|\psi\rangle)=\frac{1}{\sqrt{2}}(|0\rangle+e^{2\pi i2^{j}\theta}|1\rangle|)\otimes|\psi\rangle\)</span>。</p>
<p>所以在这些<span class="math inline">\(C-U^{2^{j}}\)</span>门作用完之后，前n个量子比特变为<span class="math inline">\(\frac{1}{\sqrt{2^{n}}}(|0\rangle+e^{2\pi i2^{n-1}\theta}|1\rangle|)\otimes\cdots\otimes(|0\rangle+e^{2\pi i2^{1}\theta}|1\rangle|)\otimes(|0\rangle+e^{2\pi i2^{0}\theta}|1\rangle|)=\frac{1}{\sqrt{2^{n}}}\sum_{k=0}^{2^{n}-1}\exp(2\pi i\theta k)|k\rangle\)</span>。</p>
<p>对其运用逆QFT之后，变为<span class="math inline">\(\frac{1}{2^{n}}\sum_{j=0}^{2^{n}-1}\sum_{k=0}^{2^{n}-1}e^{2\pi i\theta k}e^{-2\pi i\theta k/2^{n}}|j\rangle=\sum_{j=0}^{2^{n}-1}(\frac{1}{2^{n}}\sum_{k=0}^{2^{n}-1}e^{-2\pi ik(j-2^{n}\theta)})|j\rangle\)</span>。</p>
<p>整体的量子态在该量子线路作用完后变为：<span class="math inline">\(\sum_{j=0}^{2^{n}-1}(\frac{1}{2^{n}}\sum_{k=0}^{2^{n}-1}e^{-2\pi ik(j-2^{n}\theta)})|j\rangle\otimes|\psi\rangle\)</span>。</p>
<p>当<span class="math inline">\(\theta\)</span>可以用<span class="math inline">\(n\)</span>位二进制来表示的时候，即<span class="math inline">\(\theta=0.\theta_{n-1}\theta_{n-2}\cdots\theta_{0}\)</span>，因为<span class="math inline">\(j\)</span>取值从<span class="math inline">\(0\)</span>到<span class="math inline">\(2^{n}-1\)</span>，所以<span class="math inline">\(\exists j,j=2^{n}\theta\)</span>，故该状态的系数为<span class="math inline">\(1\)</span>，其他状态的系数为<span class="math inline">\(0\)</span>。所以前<span class="math inline">\(n\)</span>个量子比特变为<span class="math inline">\(|j\rangle\)</span>，故对其测量即可得到<span class="math inline">\(j\)</span>，从而得到<span class="math inline">\(\theta\)</span>。</p>
]]></content>
      <categories>
        <category>量子计算</category>
      </categories>
      <tags>
        <tag>量子计算</tag>
        <tag>QFT</tag>
      </tags>
  </entry>
</search>
